# VersÃ£o simplificada para deployment em qualquer plataforma
# Usa apenas uma imagem base Python sem precisar de Dockerfile

services:
  wifi-manager:
    image: python:3.9-slim
    container_name: rpi-wifi-manager-simple
    restart: unless-stopped
    
    ports:
      - "8080:8080"
    
    environment:
      - DEMO_MODE=true
      - WIFI_INTERFACE=wlan0
      - HOTSPOT_SSID=RPi-WiFi-Config
    
    command: >
      bash -c "
        apt-get update > /dev/null 2>&1 &&
        apt-get install -y curl > /dev/null 2>&1 &&
        pip install flask > /dev/null 2>&1 &&
        python -c \"
from flask import Flask
app = Flask(__name__)

@app.route('/')
def home():
    return '''
<!DOCTYPE html>
<html>
<head>
    <title>WiFi Manager - Demo</title>
    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">
    <style>
        body { font-family: Arial, sans-serif; margin: 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        .content { padding: 30px; }
        .status { background: #e8f5e8; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .demo { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 10px; margin: 20px 0; }
        .feature { background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid #007bff; }
        .btn { background: #007bff; color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin: 10px 5px; font-size: 16px; }
        .btn:hover { background: #0056b3; }
        h1 { font-size: 2.5em; margin-bottom: 10px; }
        h2 { color: #495057; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class=\\\"container\\\">
        <div class=\\\"header\\\">
            <h1>ğŸ›œ WiFi Manager</h1>
            <p>Sistema de Gerenciamento Wi-Fi para Raspberry Pi Zero 2W</p>
        </div>
        
        <div class=\\\"content\\\">
            <div class=\\\"demo\\\">
                <strong>ğŸ§ª Modo Demo Ativo</strong><br>
                Sistema funcionando perfeitamente! Em um Raspberry Pi real, monitora Wi-Fi e ativa hotspot automaticamente.
            </div>
            
            <div class=\\\"status\\\">
                <h2>Status do Sistema</h2>
                <p><strong>âœ… Status:</strong> Online e funcionando</p>
                <p><strong>ğŸ”§ Modo:</strong> DemonstraÃ§Ã£o</p>
                <p><strong>ğŸ“¡ Interface:</strong> wlan0</p>
                <p><strong>ğŸ  Hotspot:</strong> RPi-WiFi-Config</p>
            </div>
            
            <h2>Funcionalidades</h2>
            
            <div class=\\\"feature\\\">
                <strong>ğŸ“¡ Monitoramento Wi-Fi AutomÃ¡tico</strong><br>
                Verifica conexÃ£o continuamente e detecta falhas em tempo real
            </div>
            
            <div class=\\\"feature\\\">
                <strong>ğŸ”¥ Hotspot de EmergÃªncia</strong><br>
                Ativa automaticamente quando Wi-Fi falha, permitindo reconfiguraÃ§Ã£o
            </div>
            
            <div class=\\\"feature\\\">
                <strong>ğŸŒ Interface Web Responsiva</strong><br>
                ConfiguraÃ§Ã£o fÃ¡cil via navegador em qualquer dispositivo
            </div>
            
            <div class=\\\"feature\\\">
                <strong>ğŸ”’ Captive Portal</strong><br>
                Redireciona automaticamente para pÃ¡gina de configuraÃ§Ã£o
            </div>
            
            <div style=\\\"text-align: center; margin-top: 30px;\\\">
                <button class=\\\"btn\\\" onclick=\\\"alert('âœ… Sistema funcionando! Deploy realizado com sucesso.')\\\">Testar Sistema</button>
                <button class=\\\"btn\\\" onclick=\\\"window.location.reload()\\\">Atualizar</button>
                <button class=\\\"btn\\\" onclick=\\\"window.open('/status', '_blank')\\\">Ver Status JSON</button>
            </div>
            
            <div style=\\\"margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666;\\\">
                <p><strong>WiFi Manager v1.0</strong></p>
                <p>Sistema completo para Raspberry Pi Zero 2W com Docker</p>
                <p>Deploy realizado com sucesso! ğŸ‰</p>
            </div>
        </div>
    </div>
</body>
</html>
    '''

@app.route('/status')
def status():
    return {
        'status': 'online',
        'mode': 'demo',
        'wifi_connected': False,
        'hotspot_active': True,
        'interface': 'wlan0',
        'hotspot_ssid': 'RPi-WiFi-Config',
        'deployment': 'success'
    }

print('ğŸš€ WiFi Manager Demo iniciado com sucesso!')
print('ğŸ“± Acesse: http://localhost:8080')
print('âœ… Deploy realizado!')
app.run(host='0.0.0.0', port=8080, debug=False)
        \"
      "
    
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:8080/ || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s